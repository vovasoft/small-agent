{
  "description": "因子概述：针对办理经营贷业务，且客户所属行业为黑色金属的流水分析指标计算环节，可通过该知识因子对其中交易对手经营支出top3进行分组筛选。",
  "question": "请执行以下数据聚合计算：\n1.  **数据筛选**：从数据中筛选出同时满足以下所有条件的记录：\n    - `txDirection`字段等于“支出”。\n    - `txAmount`字段的值小于0（即为负数）。\n    - `txSummary`字段的文本内容必须同时满足以下两个条件：\n        a) 包含【设备、选矿、药剂、铁路、公路、勘探、测量】中的任意一个或多个词。\n        b) 包含【费用、运输费、服务费】中的任意一个或多个词。\n    （即，`txSummary`需要包含第一组词中的一个或几个，**并且**包含第二组词中的一个或几个）。\n2.  **分组与排序**：将筛选后的记录，按照`txCounterparty`（交易对手）进行分组。\n3.  **聚合计算**：对每个分组，将其所有记录的`txAmount`值进行求和。由于`txAmount`已是负数，求和结果即为该交易对手的总支出金额（负值）。\n4.  **结果输出**：将所有分组按总支出金额的**绝对值**从大到小排序，并取前3名。\n5.  **最终格式**：将结果以严格的JSON格式输出，结构如下：\n    {\n        \"sortResult\": [\n            {\"totalIncome\": [该对手总支出金额], \"txCounterparty\": \"[对手名称]\"},\n            ... (共3项)\n        ]\n    }\n    **关键说明**：`totalIncome`字段在此处代表“总支出”，其值应为负数。请直接使用计算出的`txAmount`负值总和，不要取绝对值或转换符号。",
  "prompt": "你是一个数据分析助手。请根据提供的交易数据，严格遵循以下指令进行处理，并输出结果：\n\n**指令**：\n1.  仅处理`txDirection`为“支出”且`txAmount`为负数（<0）的记录。\n2.  进一步筛选出`txSummary`字段中**同时包含**以下两类关键词的记录：\n    -   类别A（业务标签）：设备、选矿、药剂、铁路、公路、勘探、测量。\n    -   类别B（费用类型）：费用、运输费、服务费。\n    （例如，`txSummary`为“铁路运输费用”或“选矿车间设备服务费”则符合条件；“铁路运输”或“设备采购”则不符合，因为前者缺类别B，后者缺类别A）。\n3.  将筛选后的记录，按`txCounterparty`字段分组。\n4.  计算每个分组内所有`txAmount`值的总和。该总和即为该交易对手的“总支出”，由于`txAmount`为负，结果也为负值。\n5.  根据“总支出”的绝对值（即忽略负号的大小）对所有分组进行降序排序。\n6.  选取绝对值最大的前3个分组。\n7.  将结果组织成JSON对象，**必须严格使用以下字段名和结构**，不得有任何额外字段、文本或格式变化：\n```json\n{\n  \"sortResult\": [\n    {\n      \"totalIncome\": [计算出的总支出金额，保留原始负号],\n      \"txCounterparty\": \"[交易对手公司名称]\"\n    },\n    // ... 其余4个对象\n  ]\n}\n```\n**输出要求**：\n-   金额单位已是“万元”，无需转换。\n-   `totalIncome`字段的值必须是数字类型（浮点数或整数），不能是字符串或`null`。\n-   整个响应必须是且仅是一个合法的JSON对象。\n-   如果符合条件的记录不足3组，则`sortResult`数组包含实际数量的对象。"
}